# -*- Python -*-

# Configuration file for the 'lit' test runner.

import os
import sys
import re
import platform
import subprocess

import lit.formats

# name: The name of this test suite.
config.name = 'OMP'

# testFormat: The test format to use to interpret tests.
config.test_format = lit.formats.ShTest(True)

# suffixes: A list of file extensions to treat as test files. This is overriden
# by individual lit.local.cfg files in the test subdirectories.
config.suffixes = ['.ll', '.c', '.cpp']

config.excludes = ['CMakeLists.txt']

# test_source_root: The root path where tests are located.
config.test_source_root = '@CMAKE_CURRENT_SOURCE_DIR@'

# test_exec_root: The root path where tests should be run.
config.test_exec_root = '@CMAKE_CURRENT_BINARY_DIR@'

# config.environment['PATH'] = os.pathsep.join(['@LLVM_TOOLS_BINARY_DIR@'] + [ config.environment['PATH'] ])

# Tweak the PATH to include the tools dir.
# llvm_config.with_environment('PATH', config.llvm_tools_dir, append_path=True)

# Add site-specific substitutions.
config.substitutions.append(('%parcoach', '@PARCOACH_BIN@'))
config.substitutions.append(('%clangxx', '@CMAKE_CXX_COMPILER@'))
config.substitutions.append(('%clang', '@CMAKE_C_COMPILER@'))
config.substitutions.append(('%openmp', '@OpenMP_C_FLAGS@ @OpenMP_C_INCLUDE_FLAGS@'))
config.substitutions.append(('%filecheck', '@FILECHECK_BIN@'))

if @PARCOACH_ENABLE_COVERAGE@:
  config.environment['LLVM_PROFILE_FILE'] = os.environ['LLVM_PROFILE_FILE']


# TODO: put this at root, and exclude stuff based on feature.
